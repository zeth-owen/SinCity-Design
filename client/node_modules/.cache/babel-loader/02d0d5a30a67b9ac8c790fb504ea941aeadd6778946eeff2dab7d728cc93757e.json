{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,useHistory}from'react-router-dom';import StarRating from'./StarRating';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ShowPage=()=>{var _template$previews,_template$previews2,_template$previews2$l;const{id}=useParams();const history=useHistory();const[template,setTemplate]=useState(null);const[comments,setComments]=useState([]);const[newComment,setNewComment]=useState('');const[rating,setRating]=useState(0);const[accessDenied,setAccessDenied]=useState(false);useEffect(()=>{const fetchTemplate=async()=>{try{const response=await fetch(`https://api.envato.com/v3/market/catalog/item?id=${id}`,{headers:{'Authorization':`Bearer ${process.env.REACT_APP_ENVATO_API_KEY}`}});if(!response.ok)throw new Error('Failed to fetch template');const data=await response.json();setTemplate(data);}catch(error){console.error('Error fetching template:',error);}};const fetchComments=async()=>{try{const response=await fetch(`http://localhost:4000/comments/${id}`);if(!response.ok)throw new Error('Failed to fetch comments');const data=await response.json();setComments(data);}catch(error){console.error('Error fetching comments:',error);}};fetchTemplate();fetchComments();},[id]);const handleCommentSubmit=async e=>{e.preventDefault();const token=localStorage.getItem('token');if(!token){setAccessDenied(true);return;}try{const response=await fetch(`http://localhost:4000/templates/${id}/comments`,{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${token}`},body:JSON.stringify({comment:newComment,rating})});if(!response.ok)throw new Error('Failed to submit comment');const data=await response.json();setComments(prevComments=>[...prevComments,data]);setNewComment('');setRating(0);setAccessDenied(false);}catch(error){console.error('Error submitting comment:',error);}};const navigateBack=()=>{history.push('/websites');};const averageRating=comments.length>0?comments.reduce((total,comment)=>total+comment.rating,0)/comments.length:0;return/*#__PURE__*/_jsx(\"div\",{className:\"show-page-container\",children:template?/*#__PURE__*/_jsxs(\"div\",{className:\"show-page-content\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"page-title\",children:template.name}),((_template$previews=template.previews)===null||_template$previews===void 0?void 0:_template$previews.landscape_preview)&&/*#__PURE__*/_jsx(\"img\",{src:template.previews.landscape_preview.landscape_url,alt:template.name,className:\"template-image\"}),(_template$previews2=template.previews)!==null&&_template$previews2!==void 0&&(_template$previews2$l=_template$previews2.live_site)!==null&&_template$previews2$l!==void 0&&_template$previews2$l.href?/*#__PURE__*/_jsxs(\"p\",{className:\"live-site\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Live Site: \"}),/*#__PURE__*/_jsx(\"a\",{href:`https://themeforest.net${template.previews.live_site.href}`,target:\"_blank\",rel:\"noopener noreferrer\",className:\"live-site-link\",children:\"View Live Preview\"})]}):/*#__PURE__*/_jsx(\"p\",{children:\"No live site available\"}),/*#__PURE__*/_jsx(StarRating,{rating:rating,onRating:rate=>setRating(rate)}),/*#__PURE__*/_jsxs(\"p\",{className:\"average-rating\",children:[\"Average Rating: \",averageRating.toFixed(1)]}),/*#__PURE__*/_jsxs(\"section\",{className:\"comments-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Comments\"}),accessDenied&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:\"Access Denied: You must be logged in to submit a comment.\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleCommentSubmit,className:\"comment-form\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:newComment,onChange:e=>setNewComment(e.target.value),placeholder:\"Add a comment\",className:\"comment-textarea\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"comment-submit-button\",children:\"Submit\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"comments-list\",children:comments.map(comment=>/*#__PURE__*/_jsxs(\"div\",{className:\"comment-item\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"comment-name\",children:[comment.first_name,\" \",comment.last_name,\":\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"comment-text\",children:comment.comment})]},comment.id))})]}),/*#__PURE__*/_jsx(\"button\",{className:\"back-button\",onClick:navigateBack,children:\"Back to Websites\"})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"})});};export default ShowPage;","map":{"version":3,"names":["React","useState","useEffect","useParams","useHistory","StarRating","jsx","_jsx","jsxs","_jsxs","ShowPage","_template$previews","_template$previews2","_template$previews2$l","id","history","template","setTemplate","comments","setComments","newComment","setNewComment","rating","setRating","accessDenied","setAccessDenied","fetchTemplate","response","fetch","headers","process","env","REACT_APP_ENVATO_API_KEY","ok","Error","data","json","error","console","fetchComments","handleCommentSubmit","e","preventDefault","token","localStorage","getItem","method","body","JSON","stringify","comment","prevComments","navigateBack","push","averageRating","length","reduce","total","className","children","name","previews","landscape_preview","src","landscape_url","alt","live_site","href","target","rel","onRating","rate","toFixed","onSubmit","value","onChange","placeholder","type","map","first_name","last_name","onClick"],"sources":["/Users/zeththomas/Documents/sincity-media/client/src/websites/ShowPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, useHistory } from 'react-router-dom';\nimport StarRating from './StarRating';\n\nconst ShowPage = () => {\n  const { id } = useParams();\n  const history = useHistory();\n  const [template, setTemplate] = useState(null);\n  const [comments, setComments] = useState([]);\n  const [newComment, setNewComment] = useState('');\n  const [rating, setRating] = useState(0);\n  const [accessDenied, setAccessDenied] = useState(false);\n\n  useEffect(() => {\n    const fetchTemplate = async () => {\n      try {\n        const response = await fetch(`https://api.envato.com/v3/market/catalog/item?id=${id}`, {\n          headers: {\n            'Authorization': `Bearer ${process.env.REACT_APP_ENVATO_API_KEY}`\n          }\n        });\n        if (!response.ok) throw new Error('Failed to fetch template');\n        const data = await response.json();\n        setTemplate(data);\n      } catch (error) {\n        console.error('Error fetching template:', error);\n      }\n    };\n\n    const fetchComments = async () => {\n      try {\n        const response = await fetch(`http://localhost:4000/comments/${id}`);\n        if (!response.ok) throw new Error('Failed to fetch comments');\n        const data = await response.json();\n        setComments(data);\n      } catch (error) {\n        console.error('Error fetching comments:', error);\n      }\n    };\n\n    fetchTemplate();\n    fetchComments();\n  }, [id]);\n\n  const handleCommentSubmit = async (e) => {\n    e.preventDefault();\n\n    const token = localStorage.getItem('token');\n    if (!token) {\n      setAccessDenied(true);\n      return;\n    }\n\n    try {\n      const response = await fetch(`http://localhost:4000/templates/${id}/comments`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({ comment: newComment, rating })\n      });\n\n      if (!response.ok) throw new Error('Failed to submit comment');\n      const data = await response.json();\n      setComments((prevComments) => [...prevComments, data]);\n      setNewComment('');\n      setRating(0);\n      setAccessDenied(false);\n    } catch (error) {\n      console.error('Error submitting comment:', error);\n    }\n  };\n\n  const navigateBack = () => {\n    history.push('/websites');\n  };\n\n  const averageRating = comments.length > 0\n    ? comments.reduce((total, comment) => total + comment.rating, 0) / comments.length\n    : 0;\n\n  return (\n    <div className=\"show-page-container\">\n      {template ? (\n        <div className=\"show-page-content\">\n          <h1 className=\"page-title\">{template.name}</h1>\n          {template.previews?.landscape_preview && (\n            <img\n              src={template.previews.landscape_preview.landscape_url}\n              alt={template.name}\n              className=\"template-image\"\n            />\n          )}\n\n          {template.previews?.live_site?.href ? (\n            <p className=\"live-site\">\n              <strong>Live Site: </strong>\n              <a\n                href={`https://themeforest.net${template.previews.live_site.href}`}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"live-site-link\"\n              >\n                View Live Preview\n              </a>\n            </p>\n          ) : (\n            <p>No live site available</p>\n          )}\n\n          <StarRating rating={rating} onRating={(rate) => setRating(rate)} />\n          <p className=\"average-rating\">Average Rating: {averageRating.toFixed(1)}</p>\n\n          <section className=\"comments-section\">\n            <h2>Comments</h2>\n            {accessDenied && <p className=\"error-message\">Access Denied: You must be logged in to submit a comment.</p>}\n            <form onSubmit={handleCommentSubmit} className=\"comment-form\">\n              <textarea\n                value={newComment}\n                onChange={(e) => setNewComment(e.target.value)}\n                placeholder=\"Add a comment\"\n                className=\"comment-textarea\"\n              ></textarea><br/>\n              <button type=\"submit\" className=\"comment-submit-button\">Submit</button>\n            </form>\n            <div className=\"comments-list\">\n              {comments.map((comment) => (\n                <div key={comment.id} className=\"comment-item\">\n                  <p className=\"comment-name\">{comment.first_name} {comment.last_name}:</p>\n                  <p className=\"comment-text\">{comment.comment}</p>\n                </div>\n              ))}\n            </div>\n          </section>\n\n          <button className=\"back-button\" onClick={navigateBack}>Back to Websites</button>\n        </div>\n      ) : (\n        <p>Loading...</p>\n      )}\n    </div>\n  );\n};\n\nexport default ShowPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}